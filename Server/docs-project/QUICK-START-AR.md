# ???? ??????? ?????? - Mentora Backend

## ?? ????? ??????

### ?????????
- ? .NET 9 SDK
- ? SQL Server (Local or Express)
- ? dotnet-ef tools version 9.0.0

---

## ?? ????? ???????

### 1. ?????? ?? ????? ????????
```bash
# ?? ???? Server/src/Mentora.Infrastructure
cd D:\99_GitHub\001_Mentora\00_MentoraNew\Server\src\Mentora.Infrastructure

# ??? ??? migrations
dotnet ef migrations list --startup-project ..\Mentora.Api

# ??????? ????????
? 20251231070541_InitialMigration
```

### 2. ????? Migration (??? ??? ?????)
```bash
dotnet ef database update --startup-project ..\Mentora.Api
```

### 3. ????? ???????
```bash
cd ..\Mentora.Api
dotnet run
```

### 4. ??? Swagger UI
```
https://localhost:7XXX/swagger
```

---

## ?? ?????? ????

### 1. ????? ?????? ????
**POST** `/api/auth/signup`

```json
{
  "firstName": "????",
  "lastName": "????",
  "email": "ahmed@example.com",
  "password": "Test@123"
}
```

**??????? ????????**:
```json
{
  "isSuccess": true,
  "message": "User registered successfully"
}
```

### 2. ????? ??????
**POST** `/api/auth/login`

```json
{
  "email": "ahmed@example.com",
  "password": "Test@123",
  "deviceInfo": "Chrome/Windows"
}
```

**??????? ????????**:
```json
{
  "isSuccess": true,
  "message": "Login successful",
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "refreshToken": "AbC123..."
}
```

### 3. ????? ??? Token
**POST** `/api/auth/refresh`

```json
{
  "refreshToken": "AbC123..."
}
```

---

## ?? ??? ????? ????????

### SQL Server Management Studio
```sql
USE MentoraDb;

-- ??? ???? ???????
SELECT TABLE_NAME 
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_TYPE = 'BASE TABLE'
ORDER BY TABLE_NAME;

-- ??? ??????????
SELECT Id, Email, FirstName, LastName, IsActive, CreatedAt
FROM AspNetUsers;

-- ??? RefreshTokens
SELECT UserId, Token, ExpiresOn, IsRevoked, DeviceInfo
FROM RefreshTokens;
```

---

## ?? ?? ??????? ???????

### ???????: "Could not connect to database"
**????**:
1. ???? ?? ????? SQL Server
2. ???? ?? connection string ?? `appsettings.json`
   ```json
   "DefaultConnection": "Server=.;Database=MentoraDb;User ID=sa;Password=YOUR_PASSWORD;..."
   ```

### ???????: "Migration not found"
**????**:
```bash
# ????? migration ?????
dotnet ef migrations add InitialMigration --startup-project ..\Mentora.Api

# ????? migration
dotnet ef database update --startup-project ..\Mentora.Api
```

### ???????: "TokenCleanupService not starting"
**????**:
???? ?? Logs:
```
Token Cleanup Service started ?
```

??? ?? ????? ???? ?? `Program.cs`:
```csharp
builder.Services.AddHostedService<TokenCleanupService>();
```

---

## ?? ???? ????????

```
Server/
??? src/
?   ??? Mentora.Api/              # Web API Layer
?   ?   ??? Controllers/
?   ?   ??? Program.cs
?   ?   ??? appsettings.json
?   ?
?   ??? Mentora.Application/      # Business Logic
?   ?   ??? DTOs/
?   ?   ??? Interfaces/
?   ?   ??? Validators/
?   ?
?   ??? Mentora.Domain/           # Domain Entities
?   ?   ??? Entities/
?   ?   ?   ??? Auth/
?   ?   ?   ??? ...
?   ?   ??? Common/
?   ?
?   ??? Mentora.Infrastructure/   # Data Access
?       ??? Persistence/
?       ?   ??? ApplicationDbContext.cs
?       ??? Repositories/
?       ??? Services/
?       ??? BackgroundServices/
?           ??? TokenCleanupService.cs
?
??? docs/
?   ??? MODULE-1-AUTHENTICATION.md
?   ??? DATABASE-SETUP-SUMMARY.md
?
??? scripts/
    ??? health-check.ps1
    ??? health-check.sh
```

---

## ?? ??????? ???????

### Authentication Module (Module 1)
- ? User Registration with BCrypt
- ? JWT Access Tokens
- ? Refresh Tokens with Device Tracking
- ? Password Reset Flow
- ? Logout & Logout All Devices
- ? Token Cleanup Background Service

### Database Features
- ? GUID Primary Keys
- ? Soft Delete
- ? Auto Timestamps
- ? Enum to String Conversion
- ? Entity Relationships

### Background Services
- ? TokenCleanupService (runs every 24 hours)

---

## ?? ?????

??? ????? ?? ?????:
1. ???? ?? ??? `DATABASE-SETUP-SUMMARY.md`
2. ???? Logs ?? Console
3. ??? Error Messages ?? Swagger
4. ???? ?? Build Errors ?? Visual Studio

---

## ?? ??????? ???????

??? ?????? ?? ??? Authentication Module:

1. **Module 2**: Career Builder
2. **Module 3**: Study Scheduler
3. **Module 4**: AI Integration
4. **Module 5**: Frontend Integration

---

**?? ???????**: 31 ?????? 2024
**??????**: ? ???? ?????????
