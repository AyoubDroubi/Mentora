# ??? ???? ???? ??? ?????? ????????? - Mentora Platform

## ?? ?????????
- [???? ????](#????-????)
- [Clean Architecture](#clean-architecture)
- [??????? ???????](#???????-???????)
- [???? ????????](#????-????????)
- [????? ???????](#?????-???????)
- [???????? ??? ???????](#????????-???-???????)

---

## ?? ???? ????

Mentora ?? ???? AI-powered ?????? ?????? ????????? ??????? ??????. ?? ???? ??????? ???????? **Clean Architecture** ?? **.NET 9** ?????:

? **Separation of Concerns** - ??? ???? ??????????  
? **Testability** - ????? ????????  
? **Maintainability** - ????? ???????  
? **Scalability** - ?????? ??????  
? **Independence** - ????????? ???????

---

## ??? Clean Architecture

### ?? ?? Clean Architecture?

Clean Architecture ?? ??? ?????? ???? ???:
- **????????? ??????? (Business Logic)** ?? ???????? ???????
- **????? ????????** ??? ?????? ?????? ?????? ?? ????? ??????
- **???????** ?? ????? ???????? ?????????

### ??????? ????????

```
???????????????????????????????????????????????
?         Clean Architecture Layers           ?
???????????????????????????????????????????????
?                                             ?
?    ?????????????????????????????           ?
?    ?     Domain (Core)         ?           ?
?    ?  - Entities               ?           ?
?    ?  - Business Rules         ?           ?
?    ?????????????????????????????           ?
?                ?                             ?
?    ?????????????????????????????           ?
?    ?     Application            ?           ?
?    ?  - Use Cases              ?           ?
?    ?  - Interfaces             ?           ?
?    ?????????????????????????????           ?
?                ?                             ?
?    ?????????????????????????????           ?
?    ?    Infrastructure          ?           ?
?    ?  - Data Access            ?           ?
?    ?  - External Services      ?           ?
?    ?????????????????????????????           ?
?                ?                             ?
?    ?????????????????????????????           ?
?    ?         API/UI             ?           ?
?    ?  - Controllers            ?           ?
?    ?  - Middleware             ?           ?
?    ?????????????????????????????           ?
?                                             ?
???????????????????????????????????????????????
```

---

## ?? ??????? ???????

### 1. ?? Domain Layer (Mentora.Domain)

**?????????:** ??? ??????? - ????? ??? ???? ???????

```
Mentora.Domain/
??? Common/
?   ??? BaseEntity.cs              # ?????? ???????
??? Entities/
?   ??? Auth/
?   ?   ??? User.cs                # ???? ????????
?   ?   ??? PasswordResetToken.cs  # ???? ????? ???????
?   ??? CareerPlan.cs              # ??? ?????? ??????
?   ??? CareerStep.cs              # ????? ?????? ??????
?   ??? StudyPlan.cs               # ??? ???????
?   ??? UserProfile.cs             # ????? ??????
?   ??? UserSkill.cs               # ?????? ????????
?   ??? UserAchievement.cs         # ??????? ????????
?   ??? Skill.cs                   # ???????? ??????
?   ??? RefreshToken.cs            # ?????? ?????????
??? Enums/
?   ??? Enums.cs                   # ???? ?????????
??? AiResponse/
    ??? AiCareerPlanResponse.cs    # ???????? AI ?????? ??????
    ??? AiResource.cs              # ????? AI
```

**???????:**
- ? ?? ???? ?????? ??????
- ? ????? ??? ????? ??????? ???
- ? POCO (Plain Old CLR Objects)
- ? ???? ????? ???????? ?? ?? ?????

**???? - BaseEntity:**
```csharp
public abstract class BaseEntity
{
    public Guid Id { get; set; }
    public DateTime CreatedAt { get; set; }
    public DateTime? UpdatedAt { get; set; }
    public bool IsDeleted { get; set; }
}
```

---

### 2. ?? Application Layer (Mentora.Application)

**?????????:** ????? ????????? (Use Cases) ??????? ???????

```
Mentora.Application/
??? DTOs/
?   ??? LoginDTO.cs                # ?????? ????? ??????
?   ??? SignupDTO.cs               # ?????? ???????
?   ??? ForgotPasswordDto.cs       # ???? ???? ??????
?   ??? ResetPasswordDto.cs        # ????? ????? ???? ??????
??? Interfaces/
?   ??? IAuthService.cs            # ????? ???? ????????
?   ??? ICareerService.cs          # ????? ???? ?????? ??????
?   ??? IEmailService.cs           # ????? ???? ??????
??? Services/
    ??? (Implementations in Infrastructure)
```

**???????:**
- ? ????? ??? Domain ???
- ? ???? ???????? (Interfaces)
- ? ????? ??? DTOs ???? ????????
- ? ????? ??? Validation Logic

**???? - IAuthService:**
```csharp
public interface IAuthService
{
    Task<AuthResponseDTO> RegisterAsync(SignupDTO dto);
    Task<AuthResponseDTO> LoginAsync(LoginDTO dto);
    Task<AuthResponseDTO> RefreshTokenAsync(string refreshToken);
    Task<bool> LogoutAsync(Guid userId, string refreshToken);
}
```

---

### 3. ?? Infrastructure Layer (Mentora.Infrastructure)

**?????????:** ????? ???????? ???????

```
Mentora.Infrastructure/
??? Persistence/
?   ??? ApplicationDbContext.cs    # DbContext ???????
?   ??? Configurations/            # Entity Configurations
??? Services/
?   ??? AuthService.cs             # ????? ????????
?   ??? EmailService.cs            # ???? ?????? ??????????
?   ??? TokenCleanupService.cs     # ???? ????? ??????
??? Repositories/
?   ??? UserRepository.cs          # ?????? ??????????
?   ??? CareerPlanRepository.cs    # ?????? ??? ??????
??? Migrations/                    # EF Core Migrations
```

**???????:**
- ? ????? ??? Domain ? Application
- ? ???? ???????? ??????? ?? Application
- ? ?????? ?? ????? ????????
- ? ?????? ?? ??????? ????????

**???? - ApplicationDbContext:**
```csharp
public class ApplicationDbContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<CareerPlan> CareerPlans { get; set; }
    public DbSet<CareerStep> CareerSteps { get; set; }
    public DbSet<RefreshToken> RefreshTokens { get; set; }
    
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        // Entity Configurations
        modelBuilder.ApplyConfigurationsFromAssembly(Assembly.GetExecutingAssembly());
    }
}
```

---

### 4. ?? API Layer (Mentora.Api)

**?????????:** ???? ?????? ??????? (HTTP Endpoints)

```
Mentora.Api/
??? Controllers/
?   ??? AuthController.cs          # ???? ????? ????????
?   ??? CareerController.cs        # ???? ????? ?????? ??????
?   ??? UserController.cs          # ???? ????? ????????
??? Middleware/
?   ??? ExceptionHandlingMiddleware.cs  # ?????? ???????
?   ??? JwtMiddleware.cs           # ?????? JWT
??? Program.cs                     # ???? ?????
??? appsettings.json               # ?????????
??? Tests/
    ??? auth-tests.http            # ???????? HTTP
```

**???????:**
- ? ????? ??? Application ? Infrastructure
- ? ????? ??? Controllers
- ? ????? ??? Middleware
- ? ???? Authentication & Authorization

**???? - AuthController:**
```csharp
[ApiController]
[Route("api/[controller]")]
public class AuthController : ControllerBase
{
    private readonly IAuthService _authService;
    
    [HttpPost("register")]
    public async Task<IActionResult> Register([FromBody] SignupDTO dto)
    {
        var result = await _authService.RegisterAsync(dto);
        return Ok(result);
    }
}
```

---

## ?? ???? ????????

### ??? API ?????? (User Registration):

```
????????????????????????????????????????????????????????????
?                     Request Flow                          ?
????????????????????????????????????????????????????????????

1. HTTP Request
   ?
   ?? API Layer (AuthController)
   ?  - ?????? SignupDTO
   ?  - ????? ?? Validation
   ?
2. Application Layer (IAuthService)
   ?  - ???? ???? ???????
   ?  - ?????? UserRepository
   ?
3. Infrastructure Layer (AuthService + UserRepository)
   ?  - ????? ?? ?????? ??????????
   ?  - ???? ???? ?????? (BCrypt)
   ?  - ???? ?? ????? ????????
   ?
4. Domain Layer (User Entity)
   ?  - ???? ????????
   ?  - ????? ???????
   ?
5. Infrastructure Layer
   ?  - DbContext.SaveChanges()
   ?
6. Application Layer
   ?  - ????? JWT Token
   ?  - ????? Refresh Token
   ?  - ????? AuthResponseDTO
   ?
7. API Layer
   ?  - ????? HTTP 200 OK
   ?  - ????? ?????????
   ?
   ?? HTTP Response (JSON)

????????????????????????????????????????????????????????????
?                   Response Structure                      ?
????????????????????????????????????????????????????????????
{
  "isSuccess": true,
  "message": "?? ??????? ?????",
  "data": {
    "accessToken": "eyJhbGc...",
    "refreshToken": "abc123...",
    "user": { ... }
  }
}
```

---

## ?? ????? ???????

### 1. Dependency Inversion Principle (DIP)

```csharp
// ? ???: ???????? ???????
public class AuthService
{
    private SqlUserRepository _repo = new SqlUserRepository();
}

// ? ????: ???????? ??? Abstraction
public class AuthService : IAuthService
{
    private readonly IUserRepository _repo;
    
    public AuthService(IUserRepository repo)
    {
        _repo = repo;
    }
}
```

### 2. Single Responsibility Principle (SRP)

?? ???? ?? ??????? ????? ???:
- `User.cs` ? ???? ???? ???????? ???
- `AuthService.cs` ? ???? ???????? ???
- `UserRepository.cs` ? ???? ?????? ?????? ???????? ???

### 3. Open/Closed Principle (OCP)

```csharp
// ????? ??????? ???? ???????
public abstract class BaseEntity
{
    public Guid Id { get; set; }
    public DateTime CreatedAt { get; set; }
}

public class User : BaseEntity  // ???? ??? ?????
{
    public string Email { get; set; }
}
```

### 4. Interface Segregation Principle (ISP)

```csharp
// ? ????? ?????
public interface IService
{
    Task Register();
    Task Login();
    Task SendEmail();
    Task GenerateReport();
}

// ? ?????? ????? ??????
public interface IAuthService
{
    Task Register();
    Task Login();
}

public interface IEmailService
{
    Task SendEmail();
}
```

---

## ?? ???????? ??? ???????

### ????? ???????? (Dependency Rules)

```
??????????????????????????????????????????????
?            Dependency Flow                  ?
??????????????????????????????????????????????
?                                            ?
?   Domain ???? Application                 ?
?      ?           ?                         ?
?      ?           ?                         ?
?      ?     Infrastructure                  ?
?      ?           ?                         ?
?      ?           ?                         ?
?      ????????? API                         ?
?                                            ?
??????????????????????????????????????????????

? API ? Infrastructure ? Application ? Domain
? Application ? Domain
? Infrastructure ? Application, Domain
? Domain ? ?? ???? ????
? Application ? Infrastructure
```

### ???? ????:

```csharp
// ? ???? - API ????? ??? Application
public class AuthController : ControllerBase
{
    private readonly IAuthService _authService; // ?? Application
}

// ? ???? - Application ????? ??? Domain
public interface IAuthService
{
    Task<User> RegisterAsync(SignupDTO dto); // User ?? Domain
}

// ? ???? - Infrastructure ???? Application
public class AuthService : IAuthService
{
    private readonly ApplicationDbContext _context;
    // ???? IAuthService ?? Application
}

// ? ??? - Domain ?? ????? ??? ???
public class User // ?? Domain
{
    // ? ?? ??? ??????? ApplicationDbContext ???
    // ? ?? ??? ??????? IAuthService ???
}
```

---

## ?? ????? ??? ??????

### 1. ????? ????????
```csharp
// ???? ?????? ?????? ???? ????? ??????
[Test]
public async Task Register_ShouldCreateUser()
{
    // Arrange
    var mockRepo = new Mock<IUserRepository>();
    var authService = new AuthService(mockRepo.Object);
    
    // Act
    var result = await authService.RegisterAsync(dto);
    
    // Assert
    Assert.NotNull(result);
}
```

### 2. ????? ???????
```csharp
// ???? ????? ?? SQL Server ??? MongoDB ??? ????? ???? ???????
public class MongoUserRepository : IUserRepository
{
    // ????? ???? ???????? MongoDB
}

// ?? Startup/Program.cs
services.AddScoped<IUserRepository, MongoUserRepository>(); // ??? ??? ????!
```

### 3. ????????? ???????
- ???? ????? Domain ???? ?????
- ???? ??????? Infrastructure ???????
- ???? ????? API ???? (??? gRPC) ??????

---

## ?? ???? ????? (Package Diagram)

```
???????????????????????????????????????????????????????
?                   Dependencies                       ?
???????????????????????????????????????????????????????
?                                                     ?
?  Mentora.Api                                        ?
?  ?                                                  ?
?  ??? Mentora.Application                           ?
?  ?   ??? Mentora.Domain                            ?
?  ?                                                  ?
?  ??? Mentora.Infrastructure                        ?
?      ??? Mentora.Application                       ?
?      ??? Mentora.Domain                            ?
?                                                     ?
???????????????????????????????????????????????????????
```

---

## ?? ????? ??????

- [02-CLEAN-ARCHITECTURE-GUIDE.md](./02-CLEAN-ARCHITECTURE-GUIDE.md) - ???? ??????
- [03-PROJECT-STRUCTURE.md](./03-PROJECT-STRUCTURE.md) - ?????? ???????
- [04-DESIGN-PATTERNS.md](./04-DESIGN-PATTERNS.md) - ????? ???????
- [05-DEPENDENCY-INJECTION.md](./05-DEPENDENCY-INJECTION.md) - ??? ????????

---

**??? ?????:** 2024-12-31  
**???????:** 1.0.0
