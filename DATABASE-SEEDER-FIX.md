# ??? DatabaseSeeder - Arabic Text Fix

## ? ??????? ?????????

**??? ???????**:
```csharp
Bio = "???? ???? ?????? ???? ?????? ????????? ??????? ?????????"
University = "??????? ????????"
Major = "???? ???????"
```

**??? ???????**:
```csharp
Bio = "???? ???? ????? ???? ??????? ???????? ???????"
University = "??????? ????????"
Major = "???? ???????"
```

---

## ?? ????????? ????????

### 1. ? Saad's Profile
```csharp
Bio = "???? ???? ????? ???? ??????? ???????? ???????"
Location = "?????? ??????"
University = "??????? ????????"
Major = "???? ???????"
```

### 2. ? Saad's Career Plan
```csharp
Description = "??? ????? ???? Full Stack ????? ????? ?? .NET ? React"

Career Steps:
1. "???? ????????? ????????"
2. "???? ?????? ??????"
3. "??????? ???? ?????"
```

### 3. ? Maria's Name
```csharp
FirstName = "Maria"  // was: "?????"
LastName = "Haddad"  // was: "????"
```

### 4. ? Maria's Profile
```csharp
Bio = "????? ???? ?????? ????? ??????? ????????? ??????? ?????"
Location = "???? ????????"
University = "??????? ????????? ?? ???"
Major = "???? ????????"
```

### 5. ? Maria's Career Plan
```csharp
Description = "??? ?????? ?? ???? ???????? ??????? ????? ?? Machine Learning"

Career Steps:
1. "??????? ??? ????????"
2. "Machine Learning"
3. "?????? ????? ?? Data Science"
4. "?????? ??????? ?? ??????"
```

---

## ?? ????? ????? ?????????

### Option 1: Drop and Recreate Database (Recommended)

```bash
# Stop the application first
cd Server/src/Mentora.Api

# Drop existing database
dotnet ef database drop --force

# Create fresh database with new seed data
dotnet run
```

**???????**: Database ???? ?? ???? ?????? ??????

---

### Option 2: Manual Database Update (Alternative)

??? ?? ??? ???? ??? database? ???? ???? ???????? ??????:

```sql
-- Update Saad's Profile
UPDATE UserProfiles 
SET 
    Bio = N'???? ???? ????? ???? ??????? ???????? ???????',
    Location = N'?????? ??????',
    University = N'??????? ????????',
    Major = N'???? ???????'
WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'saad@mentora.com');

-- Update Maria's Name
UPDATE AspNetUsers
SET 
    FirstName = N'Maria',
    LastName = N'Haddad'
WHERE Email = 'maria@mentora.com';

-- Update Maria's Profile
UPDATE UserProfiles 
SET 
    Bio = N'????? ???? ?????? ????? ??????? ????????? ??????? ?????',
    Location = N'???? ????????',
    University = N'??????? ????????? ?? ???',
    Major = N'???? ????????'
WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'maria@mentora.com');

-- Update Saad's Career Plan
UPDATE CareerPlans
SET Description = N'??? ????? ???? Full Stack ????? ????? ?? .NET ? React'
WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'saad@mentora.com');

-- Update Maria's Career Plan
UPDATE CareerPlans
SET Description = N'??? ?????? ?? ???? ???????? ??????? ????? ?? Machine Learning'
WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'maria@mentora.com');

-- Update Career Steps for Saad
UPDATE CareerSteps
SET 
    Title = CASE OrderIndex
        WHEN 1 THEN N'???? ????????? ????????'
        WHEN 2 THEN N'???? ?????? ??????'
        WHEN 3 THEN N'??????? ???? ?????'
    END,
    Description = CASE OrderIndex
        WHEN 1 THEN N'????? C# ? JavaScript ???? ????'
        WHEN 2 THEN N'????? 3 ?????? ????? ???????? ASP.NET Core ? React'
        WHEN 3 THEN N'????? Portfolio? ????? LinkedIn? ??????? ?????? ??????'
    END
WHERE CareerPlanId IN (
    SELECT Id FROM CareerPlans 
    WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'saad@mentora.com')
);

-- Update Career Steps for Maria
UPDATE CareerSteps
SET 
    Title = CASE OrderIndex
        WHEN 1 THEN N'??????? ??? ????????'
        WHEN 2 THEN N'Machine Learning'
        WHEN 3 THEN N'?????? ????? ?? Data Science'
        WHEN 4 THEN N'?????? ??????? ?? ??????'
    END,
    Description = CASE OrderIndex
        WHEN 1 THEN N'????? Python? Pandas? NumPy? ? Matplotlib'
        WHEN 2 THEN N'???? Scikit-learn? TensorFlow? ?????? ?????? ?????'
        WHEN 3 THEN N'???? 5 ?????? ????? ??????? ?? ML'
        WHEN 4 THEN N'?????? ?? NLP ?? Computer Vision ??????? ?????? ??????'
    END
WHERE CareerPlanId IN (
    SELECT Id FROM CareerPlans 
    WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE Email = 'maria@mentora.com')
);
```

**??????**: ?????? `N'...'` ??? ???? ?????? ????? ??????? ??????!

---

## ?? ?????? ?? ???????

### 1. Via API (Recommended)
```bash
# Login as Saad
POST https://localhost:7000/api/auth/login
{
  "email": "saad@mentora.com",
  "password": "Saad@123"
}

# Get Profile
GET https://localhost:7000/api/UserProfile
Authorization: Bearer {token}

# Expected Response:
{
  "bio": "???? ???? ????? ???? ??????? ???????? ???????",
  "location": "?????? ??????",
  "university": "??????? ????????",
  "major": "???? ???????"
}
```

### 2. Via Frontend
```
1. Navigate to: http://localhost:8000/login
2. Login: saad@mentora.com / Saad@123
3. Go to: http://localhost:8000/profile
4. Should see Arabic text correctly displayed
```

### 3. Via Database (SQL Server)
```sql
SELECT 
    u.Email,
    u.FirstName,
    u.LastName,
    p.Bio,
    p.Location,
    p.University,
    p.Major
FROM AspNetUsers u
LEFT JOIN UserProfiles p ON u.Id = p.UserId
WHERE u.Email IN ('saad@mentora.com', 'maria@mentora.com');
```

**Expected**: All Arabic text displays correctly

---

## ?? Test Data Summary

### Saad's Profile
| Field | Value |
|-------|-------|
| Name | Saad Ahmad |
| Email | saad@mentora.com |
| Password | Saad@123 |
| Bio | ???? ???? ????? ???? ??????? ???????? ??????? |
| Location | ?????? ?????? |
| University | ??????? ???????? |
| Major | ???? ??????? |
| Level | Senior |
| Timezone | Asia/Amman |

### Maria's Profile
| Field | Value |
|-------|-------|
| Name | Maria Haddad |
| Email | maria@mentora.com |
| Password | Maria@123 |
| Bio | ????? ???? ?????? ????? ??????? ????????? ??????? ????? |
| Location | ???? ???????? |
| University | ??????? ????????? ?? ??? |
| Major | ???? ???????? |
| Level | Graduate |
| Timezone | Asia/Dubai |

---

## ?? Troubleshooting

### Issue: Still seeing `????` after seeding

**Cause**: File encoding or database collation issue

**Solutions**:

1. **Check File Encoding**
   - File should be saved as UTF-8 with BOM
   - Visual Studio should auto-detect UTF-8

2. **Check Database Collation**
```sql
SELECT DATABASEPROPERTYEX('YourDatabaseName', 'Collation');
-- Should be: SQL_Latin1_General_CP1_CI_AS or Arabic_CI_AS
```

3. **Verify Column Types**
```sql
SELECT 
    TABLE_NAME,
    COLUMN_NAME,
    DATA_TYPE,
    CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'UserProfiles'
AND COLUMN_NAME IN ('Bio', 'Location', 'University', 'Major');

-- All should be NVARCHAR (not VARCHAR)
```

4. **Force UTF-8 in Connection String**
```json
"ConnectionStrings": {
  "DefaultConnection": "Server=...;Database=...;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=False"
}
```

---

## ?? Notes

### Why `N'...'` in SQL?
- `N` prefix tells SQL Server the string is Unicode (NVARCHAR)
- Without `N`, it treats as VARCHAR and corrupts Arabic text
- Always use `N'...'` for non-English text in SQL

### DatabaseSeeder.cs Encoding
- File must be UTF-8 with BOM
- Visual Studio 2022 defaults to UTF-8
- Check encoding: File ? Advanced Save Options

### Entity Framework Core
- EF Core automatically uses NVARCHAR for strings
- No special configuration needed
- Just ensure connection string has proper encoding

---

## ? Success Indicators

After applying fixes:

1. ? **DatabaseSeeder.cs**
   - No `????` in source code
   - All Arabic text readable in IDE

2. ? **Database**
   - Arabic text stored correctly
   - NVARCHAR columns used
   - Proper collation

3. ? **API Response**
   - Arabic text in JSON response
   - No encoding issues
   - UTF-8 headers

4. ? **Frontend Display**
   - Arabic text renders correctly
   - RTL direction if needed
   - No placeholder characters

---

## ?? Quick Fix Commands

```bash
# Complete Reset (Recommended)
cd Server/src/Mentora.Api
dotnet ef database drop --force
dotnet run

# Or just rebuild
dotnet clean
dotnet build
dotnet run
```

---

**File Modified**: `Server/src/Mentora.Infrastructure/Data/DatabaseSeeder.cs`  
**Lines Changed**: ~50 lines with Arabic text  
**Fix Status**: ? Complete  
**Test Status**: ?? Ready for Testing

---

## ?? Related Files

- `Server/src/Mentora.Infrastructure/Data/DatabaseSeeder.cs` - Main file fixed
- `Server/src/Mentora.Api/Program.cs` - UTF-8 JSON encoder configured
- `Client/src/services/api.js` - UTF-8 headers added
- `Server/src/Mentora.Application/DTOs/UserProfile/UpdateUserProfileDto.cs` - Validation updated

---

**Last Updated**: 2024-12-31  
**Version**: 1.0.0  
**Status**: ? Fixed & Ready
